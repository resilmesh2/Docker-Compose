import json
import logging
from typing import Any


class Vulnerability:
    def __init__(self) -> None:
        """
        Initializes a Vulnerability object with default attributes.

        Attributes include CVE identifier, description, CWE, CVSS metrics (v2, v3.0, v3.1, v4.0),
        CPE types, configurations, publication dates, and impact results.
        """
        self.cve: str = ""
        self.description: str = ""
        self.cwe: set[str] = set()
        self.cvssv2: dict[str, Any] = {}
        self.cvssv30: dict[str, Any] = {}
        self.cvssv31: dict[str, Any] = {}
        self.cvssv40: dict[str, Any] = {}
        self.cpe_type: set[str] = set()
        self.cpe_configurations: list[Any] = []
        self.published: str = ""
        self.lastModified: str = ""
        self.result_impacts: list[str] = []
        self.ref_tag: set[str] = set()

    def to_dict(self) -> dict[str, Any]:
        """
        Converts the Vulnerability object to a dictionary.

        :return: A dictionary containing all attributes of the Vulnerability object.
        """
        return {
            "cve": self.cve,
            "description": self.description,
            "cwe": list(self.cwe),
            "cvssv2": self.cvssv2,
            "cvssv30": self.cvssv30,
            "cvssv31": self.cvssv31,
            "cvssv40": self.cvssv40,
            "cpe_type": list(self.cpe_type),
            "cpe_configurations": self.cpe_configurations,
            "published": self.published,
            "lastModified": self.lastModified,
            "result_impacts": self.result_impacts,
            "tags": list(self.ref_tag),
        }


def save_data_to_file(data: Any, filename: str) -> None:
    """
    Saves the provided data to a JSON file.

    :param data: The data to be saved.
    :param filename: The name of the file to save the data to.
    :raises Exception: If an error occurs during file writing.
    """
    try:
        with open(filename, "w") as file:
            json.dump(data, file, indent=4)
        logging.info(f"Data successfully saved to {filename}")
    except Exception as e:
        logging.exception(f"Error: Unable to save data to file. {e}")
