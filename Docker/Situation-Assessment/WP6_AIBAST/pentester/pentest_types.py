from dataclasses import dataclass, field
from typing import List, Dict, Optional, TypedDict
from enum import Enum

@dataclass
class ScanSummary:
    total: int
    successful: int
    failures: int

@dataclass
class ScanResult:
    action: str
    task_id: int
    ips: list[str]
    new_nodes: list[str]
    failed_nodes: list[str]
    summary: ScanSummary

@dataclass
class PlannerInfo: 
    ip: str
    description: str
    output: str
    output_summary: str
    iteration_number: int

@dataclass
class GraphData:
    ip: str
    description: str
    output_summary: str
    iteration_number: int
### need to remove this
class PentestState(TypedDict):
    pending_tasks: List[Dict]  # Temporary working list (reused for different phases)
    completed_tasks: List[
        Dict
    ]  # Tasks that finished execution but need memory processing
    current_phase: str  # "execution" | "memory_saving"
    errors: List[str]
    graph_data: List[Dict]  # List of dicts instead of a single dict


class TaskType(Enum):
    NMAP_SCAN = "nmap_scan"
    METASPLOIT = "metasploit"

@dataclass
class Task:
    task_id: int
    description: str
    target: str
    type: TaskType
    error_count: int = 0
    dependencies: List[int] = field(default_factory=list)
    command: Optional[str] = None
    command_output: Optional[str] = None
    error: Optional[str] = None
    task_summary: Optional[str] = None